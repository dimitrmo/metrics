services:

  ws-server-go:
    container_name: ws-server-go
    restart: unless-stopped
    build:
      dockerfile: Dockerfile
      context: ws-server-go
    ports:
      - "8080:8080"

  ws-server-rs:
    container_name: ws-server-rs
    restart: unless-stopped
    build:
      dockerfile: Dockerfile
      context: ws-server-rs
    ports:
      - "8081:8081"

  grafana-alloy:
    container_name: grafana-alloy
    restart: unless-stopped
    build:
      dockerfile: Dockerfile
      context: grafana-alloy
    command:
      - "run"
      - "/etc/alloy/config.alloy"
      - "--server.http.listen-addr=0.0.0.0:12345" # this is important
      - "--storage.path=/var/lib/alloy/data"
    ports:
      - "12345:12345"
    links:
      - ws-server-go
      - ws-server-rs
